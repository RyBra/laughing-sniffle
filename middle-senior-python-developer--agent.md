# Задача:
Реализовать агента для сбора информации об ОС Windows, используя микросервисную архитектуру.

Скрипт должен запускаться с CLI аргументом: путь к файлу с командами. 
При запуске агент должен считать команды из файла. При наличии команды «inventory» (одной или нескольких) - выполнить сбор информации об ОС Windows с хоста, на котором он запущен.

Пример файла с командами:
```
inventory
audit
install 7zip
inventory
reboot
```

Сбор данных должен осуществляться отдельным сервисом.
Результат сбора данных записать в файл payload.json.
Иные команды агент должен игнорировать.


## Для проверки задания требуется:
- предоставить исходные коды, документация/сопроводительные комментарии приветствуются
- собрать и предоставить `requirements.txt` для проверки работы в venv

## 1. Требования к программе:
### 1.1. Основные функции программы: 
- проверить наличие конфигурационного файла при запуске;
- считать команды из файла, указанного в CLI аргументе. Подходящие команды (в данном случае - «inventory») передать отдельному сервису на исполнение;
- осуществить определение версии Windows ОС на запускаемом хосте;
- вести журнал (лог) своей работы и возникающих ошибок;
- использовать очереди задач и результатов, реализовать защиту от переполнения очередей.


### 1.2. Запуск программы
При запуске, агент должен проверить наличие конфигурационного файла `config.ini` в той же директории, где располагается сам исполняемый файл. При обнаружении файла - необходимо прочитать из него необходимые параметры в память программы. 

Пример файла `config.ini`:
```ini
[logging]
level = info
log_path = C:\Program Files (x86)\TestCollector\

[workers]
InventoryWorkers = 1
```

### 1.3. Воркеры и их функции
1. Сервис диспетчеризации
Центральный компонент управления, осуществляющий дисперчеризацию входящих задач. Его функции включают:
- Управление очередью: обработка входящих задач.
- Валидация: проверка легитимности команды - сопоставление команды с разрешенным списком действий.
- Диспетчеризация: в зависимости от содержания входящей команды передавать выполнение задачи конкретному сервису, перекладывая её в соответствующую очередь.

2. Сервис инвентаризации
Сервис, отвечающий за сбор данных о системе. При получении задачи «inventory» он инициирует сбор информации о версии ОС Windows и записывает результат в файл.

Основным источником данных служит ветка реестра: HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion
Воркер выполняет чтение следующих параметров для формирования детального профиля ОС:
- ProductName / DisplayVersion: Идентификация коммерческого названия и маркетингового индекса версии (например, Windows 11 23H2).
- CurrentBuild / UBR (Update Build Revision): Определение точного номера сборки и уровня накопительных обновлений для анализа уязвимостей.
- InstallDate: Получение метки времени установки системы.
- EditionID: Определение редакции (Enterprise, Pro, Home).

Собранные данные необходимо вывести в текстовый файл payload.json в той же директории, где находится сам скрипт, и записать в формате json с использованием следующей структуры:
```json
{
  "os": {
    "ProductName": "Windows Server 2019 Standard",
    "CurrentBuild": "19045",
    "DisplayVersion": "1809",
    "EditionID": "ProfessionalWorkstation"
  }
}
```

> количество запускаемых сервисов должно настраиваться через конфигурационный файл. 


### 1.5 Журналирование
Агент должен записывать логи своей работы и возникающие ошибки в текстовый файл `log.txt`. Путь расположения файла `log.txt` настраивается в конфигурационном файле. 

При перезапуске программы, ранее созданный `log.txt` не должен удаляться.

Каждая запись должна содержать временную метку, уровень записи, текст сообщения.
Значения уровней логирования:
- debug, 
- info, 
- warning, 
- error.

> Будет плюсом, если детализацией логирования можно будет управлять на основе параметра конфигурационного файла 
> `config.ini`: log_level. Значения уровней логирования: 
> - debug, 
> - info, 
> - warning, 
> - error.
